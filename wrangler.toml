name = "errl-portal-forum"
compatibility_date = "2026-01-14"
main = ".open-next/worker.js"
compatibility_flags = ["nodejs_compat"]
assets = { directory = ".open-next/assets", binding = "ASSETS" }

# Increase CPU time limit to avoid "Worker exceeded CPU time limit" on heavy pages (e.g. homepage with many DB queries)
# Default is 30s; 60s gives headroom for Next.js SSR + D1 on complex routes
[limits]
cpu_ms = 60000

# Production (Default)
[[d1_databases]]
binding = "DB"
database_name = "errl_forum_db"
database_id = "f6acc52e-a23b-4a6c-8b62-c93892e41940"

[[r2_buckets]]
binding = "UPLOADS"
bucket_name = "errl-forum-uploads"

# Preview Environment
[env.preview]
name = "errl-portal-forum-preview"

[[env.preview.d1_databases]]
binding = "DB"
database_name = "errl_forum_db"
database_id = "f6acc52e-a23b-4a6c-8b62-c93892e41940"

[[env.preview.r2_buckets]]
binding = "UPLOADS"
bucket_name = "errl-forum-uploads"
